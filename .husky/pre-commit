#!/usr/bin/env sh
# Pre-commit hook - formats and lints staged files before commit
# Note: If hooks aren't running, run `npm run prepare` to initialize Husky

set -e

# Format all files
npm run format

# Stage any formatting changes to tracked files (not untracked)
git add -u

# Lint staged .ts/.tsx files to catch errors before they're committed
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM -- '*.ts' '*.tsx' | tr '\n' ' ')
if [ -n "$STAGED_FILES" ]; then
	echo "Linting staged files..."
	npx eslint --cache $STAGED_FILES
fi
